{"remainingRequest":"/Users/apple/Desktop/课程/Java/java课程设计/charging_station/web/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/apple/Desktop/课程/Java/java课程设计/charging_station/web/src/views/ChongDianZhuang.vue?vue&type=style&index=0&id=426d687e&scoped=true&lang=css","dependencies":[{"path":"/Users/apple/Desktop/课程/Java/java课程设计/charging_station/web/src/views/ChongDianZhuang.vue","mtime":1670248952413},{"path":"/Users/apple/Desktop/课程/Java/java课程设计/charging_station/web/node_modules/css-loader/dist/cjs.js","mtime":1668068761139},{"path":"/Users/apple/Desktop/课程/Java/java课程设计/charging_station/web/node_modules/vue-loader-v16/dist/stylePostLoader.js","mtime":1668068762418},{"path":"/Users/apple/Desktop/课程/Java/java课程设计/charging_station/web/node_modules/postcss-loader/src/index.js","mtime":1668068761558},{"path":"/Users/apple/Desktop/课程/Java/java课程设计/charging_station/web/node_modules/cache-loader/dist/cjs.js","mtime":1668068760194},{"path":"/Users/apple/Desktop/课程/Java/java课程设计/charging_station/web/node_modules/vue-loader-v16/dist/index.js","mtime":1668068761558}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5jb250YWluZXJ7CiAgbWFyZ2luLXRvcDoyMHB4Owp9CgpkaXYuZXJyb3ItbWVzc2FnZSB7CiAgY29sb3I6IHJlZDsKfQo="},{"version":3,"sources":["/Users/apple/Desktop/课程/Java/java课程设计/charging_station/web/src/views/ChongDianZhuang.vue"],"names":[],"mappings":";AA2SA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACR,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACjB;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EAChB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACZ","file":"/Users/apple/Desktop/课程/Java/java课程设计/charging_station/web/src/views/ChongDianZhuang.vue","sourceRoot":"","sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"card\">\n        <div class=\"card-header\">\n          <span style=\"font-size: 130%\">充电桩</span>\n          <button v-if=\"($store.state.user.id==1||$store.state.user.id==2||$store.state.user.id==3)\" type=\"button\" class=\"btn btn-success float-end\" data-bs-toggle=\"modal\" data-bs-target=\"#add-charging-btn\">\n            创建充电桩\n         </button>\n         <!-- Modal -->\n         <div class=\"modal fade\" id=\"add-charging-btn\" tabindex=\"-1\">\n          <div class=\"modal-dialog\">\n              <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                  <h5 class=\"modal-title\">创建充电桩</h5>\n                  <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n              </div>\n              <div class=\"modal-body\">\n                  <div class=\"mb-3\">\n                      <label for=\"add-charging-chargingState\" class=\"form-label\">充电状态(1:使用中,0:未使用)</label>\n                      <input v-model=\"chargingadd.chargingState\" type=\"text\" class=\"form-control\" id=\"add-charging-chargingState\" placeholder=\"请输入充电桩的充电状态\">\n                  </div>\n                  <div class=\"mb-3\">\n                      <label for=\"add-charging-runningState\" class=\"form-label\">运转状态(1:良好,0:故障)</label>\n                      <input v-model=\"chargingadd.runningState\" class=\"form-control\" id=\"add-charging-runningState\" rows=\"3\" placeholder=\"请输入充电桩的运转状态\">\n                  </div>\n                  <div class=\"mb-3\">\n                    <label for=\"add-charging-address\" class=\"form-label\">地址</label>\n                    <textarea v-model=\"chargingadd.address\" class=\"form-control\" id=\"add-charging-address\" rows=\"3\" placeholder=\"请输入充电桩的地址\"></textarea>\n                </div>\n                 \n              </div>\n              <div class=\"modal-footer\">\n                  <div class=\"error-message\">{{ chargingadd.error_message }}</div>\n                  <button type=\"button\" class=\"btn btn-primary\" @click=\"add_charging\">创建</button>\n                  <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">取消</button>\n              </div>\n              </div>\n            </div>\n         </div>\n        </div>\n        <div class=\"card-body\">\n          <table class=\"table table-striped\">\n            <thead>\n              <tr>\n                <th scope=\"col\">编号</th>\n                <th scope=\"col\">充电状态</th>\n                <th scope=\"col\">运转状态</th>\n                <th scope=\"col\">地址</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"charging in chargings\" :key=\"charging.charging_id\">\n                <th>{{ charging.chargingId }}</th>\n                <th v-if=\"(charging.chargingState==1)\">使用中</th>\n                <th v-else>未使用</th>\n                <th v-if=\"(charging.runningState==1)\">良好</th>\n                <th v-else>故障</th>\n                <th>{{ charging.address }}</th>\n                <th>\n                  <button v-if=\"($store.state.user.id==1||$store.state.user.id==2||$store.state.user.id==3)\" type=\"button\" class=\"btn btn-secondary\" style=\"margin-right: 10px;\" data-bs-toggle=\"modal\" :data-bs-target=\"('#update-charging-modal-' + charging.chargingId)\">修改</button>\n                  <button v-if=\"($store.state.user.id==1||$store.state.user.id==2||$store.state.user.id==3)\" type=\"button\" class=\"btn btn-danger\" style=\"margin-right: 10px;\" @click=\"remove_charging(charging)\">删除</button>\n                  <button type=\"button\" class=\"btn btn-success\" style=\"margin-right: 10px;\" data-bs-toggle=\"modal\" :data-bs-target=\"('#use-charging-modal-' + charging.chargingId)\">充电</button>\n\n                  <div class=\"modal fade\" :id=\"('update-charging-modal-' + charging.chargingId)\" tabindex=\"-1\">\n                    <div class=\"modal-dialog\">\n                        <div class=\"modal-content\">\n                        <div class=\"modal-header\">\n                            <h5 class=\"modal-title\">创建充电桩</h5>\n                            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                        </div>\n                        <div class=\"modal-body\">\n                            <div class=\"mb-3\">\n                                <label for=\"add-charging-chargingState\" class=\"form-label\">充电状态(1:使用中,0:未使用)</label>\n                                <input v-model=\"charging.chargingState\" type=\"text\" class=\"form-control\" id=\"add-charging-chargingState\" placeholder=\"请输入充电桩的充电状态\">\n                            </div>\n                            <div class=\"mb-3\">\n                                <label for=\"add-charging-runningState\" class=\"form-label\">运转状态(1:良好,0:故障)</label>\n                                <input v-model=\"charging.runningState\" class=\"form-control\" id=\"add-charging-runningState\" rows=\"3\" placeholder=\"请输入充电桩的运转状态\">\n                            </div>\n                            <div class=\"mb-3\">\n                              <label for=\"add-charging-address\" class=\"form-label\">地址</label>\n                              <textarea v-model=\"charging.address\" class=\"form-control\" id=\"add-charging-address\" rows=\"3\" placeholder=\"请输入充电桩的地址\"></textarea>\n                          </div>\n                           \n                        </div>\n                        <div class=\"modal-footer\">\n                            <div class=\"error-message\">{{ charging.error_message }}</div>\n                            <button type=\"button\" class=\"btn btn-primary\" @click=\"update_charging(charging)\">保存修改</button>\n                            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">取消</button>\n                        </div>\n                        </div>\n                      </div>\n                   </div>\n\n\n\n                   <div class=\"modal fade\" :id=\"('use-charging-modal-' + charging.chargingId)\" tabindex=\"-1\">\n                    <div class=\"modal-dialog\">\n                        <div class=\"modal-content\">\n                        <div class=\"modal-header\">\n                            <h5 class=\"modal-title\">充电订单</h5>\n                            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                        </div>\n                        <div class=\"modal-body\">\n                            <div class=\"mb-3\">\n                                <label for=\"use-charging-chargingId\" class=\"form-label\">充电桩编号: {{ charging.chargingId }}</label>\n                            </div>\n                            <div class=\"mb-3\">\n                              <label for=\"use-charging-chargingState\" class=\"form-label\">地址: {{ charging.address  }} </label>\n                            </div>\n                            <div class=\"mb-3\">\n                              <label for=\"use-charging-time\" class=\"form-label\"> 充电时长: </label>\n                              <input v-model=\"charging.time\" style=\"width:50px\"  id=\"use-charging-time\" >\n                              <label for=\"use-charging-time\" class=\"form-label\"> 分钟 </label>\n                            </div>\n                            <div class=\"mb-3\">\n                              <label for=\"use-charging-money\" class=\"form-label\">金额: {{ (charging.time * 0.05).toFixed(2) }} 元</label>\n                            </div>\n                           \n                        </div>\n                        <div class=\"modal-footer\">\n                            <div class=\"error-message\">{{ charging.error_message }}</div>\n                            <button type=\"button\" class=\"btn btn-success\" @click=\"use_charging(charging)\">开始充电</button>\n                            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">取消</button>\n                        </div>\n                        </div>\n                      </div>\n                   </div>\n                  \n\n                </th>\n              </tr>\n            </tbody>\n          </table>\n  \n        </div>\n    </div>\n</div>\n\n</template>\n\n\n<script>\nimport { ref,reactive } from 'vue';\nimport $ from 'jquery'\nimport { useStore } from 'vuex'\nimport { Modal } from 'bootstrap/dist/js/bootstrap'\n\nexport default{\n  name: 'ChongDianZhuang',\n  setup(){\n    const store = useStore();\n    let chargings = ref([]);\n\n    const chargingadd = reactive({\n      chargingState: \"\",\n      runningState: \"\",\n      address: \"\",\n      error_message: \"\",\n    });\n\n\n    $.ajax({\n      url: \"http://127.0.0.1:3000/charging/getlist/\",\n      type: \"get\",\n      headers: {\n          Authorization: \"Bearer \" + store.state.user.token,\n      },\n      success(resp) {\n        chargings.value = resp;\n      },\n    });\n\n    const refresh_chargings = () => {\n        $.ajax({\n            url: \"http://127.0.0.1:3000/charging/getlist/\",\n            type: \"get\",\n            headers: {\n                Authorization: \"Bearer \" + store.state.user.token,\n            },\n            success(resp) {\n                chargings.value = resp;\n            }\n        })\n    }\n\n    refresh_chargings();\n\n    const add_charging = () => {\n            chargingadd.error_message = \"\";\n            $.ajax({\n                url: \"http://127.0.0.1:3000/charging/add/\",\n                type: \"post\",\n                data: {\n                    chargingState: chargingadd.chargingState,\n                    runningState: chargingadd.runningState,\n                    address: chargingadd.address,\n                },\n                headers: {\n                    Authorization: \"Bearer \" + store.state.user.token,\n                },\n                success(resp) {\n                  console.log(resp);\n                    if (resp.error_message === \"success\") {\n                        chargingadd.chargingState = \"\",\n                        chargingadd.runningState = \"\",\n                        chargingadd.address = \"\",\n                        Modal.getInstance(\"#add-charging-btn\").hide();\n                        refresh_chargings();\n                    } else {\n                        chargingadd.error_message = resp.error_message;\n                    }\n                }\n            })\n        }\n\n\n    const remove_charging = (charging) => {\n        $.ajax({\n            url: \"http://127.0.0.1:3000/charging/delete/\",\n            type: \"post\",\n            data: {\n                chargingId: charging.chargingId,\n            },\n            headers: {\n                Authorization: \"Bearer \" + store.state.user.token,\n            },\n            success(resp) {\n                if (resp.error_message === \"success\") {\n                    refresh_chargings();\n                }\n            }\n        })\n    }\n    const update_charging = (charging) => {\n            chargingadd.error_message = \"\";\n            $.ajax({\n                url: \"http://127.0.0.1:3000/charging/update/\",\n                type: \"post\",\n                data: {\n                    chargingId: charging.chargingId,\n                    chargingState: charging.chargingState,\n                    runningState: charging.runningState,\n                    address: charging.address,\n                },\n                headers: {\n                    Authorization: \"Bearer \" + store.state.user.token,\n                },\n                success(resp) {\n                    if (resp.error_message === \"success\") {\n                        Modal.getInstance('#update-charging-modal-' + charging.chargingId).hide();\n                        refresh_chargings();\n                    } else {\n                        charging.error_message = resp.error_message;\n                    }\n                }\n            })\n        }\n      const use_charging = (charging) => {\n          chargingadd.error_message = \"\";\n          $.ajax({\n              url: \"http://127.0.0.1:3000/charging/using/\",\n              type: \"post\",\n              data: {\n                  chargingId: charging.chargingId,\n                  chargingState: charging.chargingState,\n                  runningState: charging.runningState,\n                  time: charging.time,\n                  money: (charging.time * 0.05).toFixed(2),\n              },\n              headers: {\n                  Authorization: \"Bearer \" + store.state.user.token,\n              },\n              success(resp) {\n                  console.log(resp);\n                  if (resp.error_message === \"success\") {\n                      Modal.getInstance('#use-charging-modal-' + charging.chargingId).hide();\n                      refresh_chargings();\n                      reload();\n                  } else {\n                      charging.error_message = resp.error_message;\n                  }\n              }\n          })\n      }\n    return{\n      chargings,\n      refresh_chargings,\n      add_charging,\n      chargingadd,\n      remove_charging,\n      update_charging,\n      use_charging,\n    }\n  }\n}\n</script>\n\n<style scoped>\n.container{\n  margin-top:20px;\n}\n\ndiv.error-message {\n  color: red;\n}\n</style>"]}]}